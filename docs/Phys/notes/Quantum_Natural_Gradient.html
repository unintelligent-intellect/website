<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Haruki YAGI - Quantum Natural Gradient</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Haruki YAGI</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Physics.html">
 <span class="menu-text">Physics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Music.html">
 <span class="menu-text">Music</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#natural-gradient" id="toc-natural-gradient" class="nav-link active" data-scroll-target="#natural-gradient">Natural Gradient</a>
  <ul class="collapse">
  <li><a href="#vanilla-gradient" id="toc-vanilla-gradient" class="nav-link" data-scroll-target="#vanilla-gradient">Vanilla Gradient</a></li>
  <li><a href="#natural-gradient-1" id="toc-natural-gradient-1" class="nav-link" data-scroll-target="#natural-gradient-1">Natural Gradient</a></li>
  </ul></li>
  <li><a href="#fisher情報行列" id="toc-fisher情報行列" class="nav-link" data-scroll-target="#fisher情報行列">Fisher情報行列</a>
  <ul class="collapse">
  <li><a href="#重要な関係式" id="toc-重要な関係式" class="nav-link" data-scroll-target="#重要な関係式">重要な関係式</a></li>
  <li><a href="#kl情報量の計量" id="toc-kl情報量の計量" class="nav-link" data-scroll-target="#kl情報量の計量">KL情報量の計量</a></li>
  </ul></li>
  <li><a href="#quantum-natural-gradient" id="toc-quantum-natural-gradient" class="nav-link" data-scroll-target="#quantum-natural-gradient">Quantum Natural Gradient</a>
  <ul class="collapse">
  <li><a href="#量子状態間の距離の定義" id="toc-量子状態間の距離の定義" class="nav-link" data-scroll-target="#量子状態間の距離の定義">量子状態間の距離の定義</a></li>
  <li><a href="#距離の公理" id="toc-距離の公理" class="nav-link" data-scroll-target="#距離の公理">距離の公理</a></li>
  <li><a href="#性質" id="toc-性質" class="nav-link" data-scroll-target="#性質">性質</a></li>
  <li><a href="#計量とquantum-natural-gradient" id="toc-計量とquantum-natural-gradient" class="nav-link" data-scroll-target="#計量とquantum-natural-gradient">計量とQuantum Natural Gradient</a></li>
  <li><a href="#古典情報量との対応" id="toc-古典情報量との対応" class="nav-link" data-scroll-target="#古典情報量との対応">古典情報量との対応</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quantum Natural Gradient</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="natural-gradient" class="level1">
<h1>Natural Gradient</h1>
<section id="vanilla-gradient" class="level2">
<h2 class="anchored" data-anchor-id="vanilla-gradient">Vanilla Gradient</h2>
<p>最急降下法などで用いられる勾配を、<span class="citation" data-cites="Josh2019">Izaac (<a href="#ref-Josh2019" role="doc-biblioref">2019</a>)</span> に準じて、ここではVanilla Gradientと呼ぶことにする。</p>
<p>損失関数をパラメータ<span class="math inline">\(\theta^i\)</span>の関数として、 <span class="math inline">\(L(\theta)\)</span> としよう。 Vanilla Gradientは単純に損失関数の勾配で定義される：</p>
<p><span class="math display">\[\partial_i L=\frac{\partial L(\theta)}{\partial \theta^i}\]</span></p>
<p>この勾配から最急降下法で用いられる更新式を作ると、幅を <span class="math inline">\(\alpha&gt;0\)</span> 、パラメータの新しさを <span class="math inline">\(\cdot [k]\)</span> などとして表すこととして、ベクトルの変換性を無視すれば</p>
<p><span class="math display">\[\theta^i[k+1]=\theta^i[k]-\alpha\left.\frac{\partial L(\theta)}{\partial \theta^i}\right|_{\theta^i=\theta^i[k]}\]</span></p>
<p>となる。</p>
<p>これ以降、物理学とのアナロジーを意識しながら議論を進める。 素直な対応としては、損失関数をパラメータ空間上に定義された実スカラー場、 勾配をパラメータ空間上に定義された実ベクトル場とするアナロジーが考えられる。</p>
</section>
<section id="natural-gradient-1" class="level2">
<h2 class="anchored" data-anchor-id="natural-gradient-1">Natural Gradient</h2>
<p>Vanilla Gradientにはベクトルの変換性が一致していないという問題がある。 そこで、勾配部分の変換性を計量テンソルを使って強引に合わせてみる：</p>
<p><span class="math display">\[\theta^i[k+1]=\theta^i[k]-\alpha g^{ij}\left.\frac{\partial L(\theta)}{\partial \theta^j}\right|_{\theta^j=\theta^j[k]}\]</span></p>
<p>ここで登場した逆計量つき勾配が<strong>Natural Gradient(自然勾配)</strong>である。</p>
<p>自然勾配を用いたパラメータ更新ダイナミクスは座標変換に対して不変に保たれる。 このことを示してみよう。 まず、変換 <span class="math inline">\(\eta^j=T_i^j\theta^i\)</span> に対してベクトルが不変であることは、 <span class="math inline">\(A'^j(\eta)=T_k^jA^k(\theta)\)</span> と変換することに同値であった。</p>
<p><span class="math display">\[\frac{\partial L'(\eta)}{\partial \eta^j}=\frac{\partial \theta^k}{\partial \eta^j}\frac{\partial L(\theta)}{\partial \theta^k}=\left(T^{-1}\right)^k_j \frac{\partial L(\theta)}{\partial \theta^k}\]</span> <span class="math display">\[T_i^j\left(T^{-1}\right)^k_j=\delta^k_i\]</span> であるから、</p>
<p><span class="math display">\[
\eta^j[n+1]
=\eta^j[n]-\alpha g^{jk}\left.\frac{\partial L'(\eta)}{\partial \eta^k}\right|_{\eta^k=\eta^k[n]}
=T_i^j\theta^i[n]-\alpha T_m^jT_o^kg^{mo}\left(T^{-1}\right)_k^i\left.\frac{\partial L(\theta)}{\partial \theta^i}\right|_{\theta^i=\theta^i[n]}
\]</span></p>
<p><span class="math display">\[
=T_i^j\theta^i[n]-\alpha T_m^j\delta_o^i g^{mo}\left.\frac{\partial L(\theta)}{\partial \theta^i}\right|_{\theta^i=\theta^i[n]}
=T_i^j\theta^i[n]-\alpha T_m^j g^{mi}\left.\frac{\partial L(\theta)}{\partial \theta^i}\right|_{\theta^i=\theta^i[n]}
\]</span> <span class="math display">\[
=T_i^j\theta^i[n]-\alpha T_i^j g^{ik}\left.\frac{\partial L(\theta)}{\partial \theta^k}\right|_{\theta^k=\theta^k[n]}
=T_i^j\left[\theta^i[n]-\alpha g^{ik}\left.\frac{\partial L(\theta)}{\partial \theta^k}\right|_{\theta^k=\theta^k[n]}\right]=T_i^j\theta^j[n+1]
\]</span></p>
<p>となり、<span class="math inline">\(\eta^j[n+1]=T_i^j\theta^j[n+1]\)</span> が示せた。 これは座標変換に対して不変なベクトルの変換性に従っているので、 自然勾配を用いたダイナミクスは座標変換に対して不変であることがわかる。 計算すればすぐに分かるが、最急降下法の更新ダイナミクスは座標変換に対して不変でない。</p>
<p><span class="citation" data-cites="amari-naturalgradient">Amari (<a href="#ref-amari-naturalgradient" role="doc-biblioref">1998</a>)</span> によると、自然勾配は単純な勾配よりも速く損失関数を最小化することが知られている。</p>
</section>
</section>
<section id="fisher情報行列" class="level1">
<h1>Fisher情報行列</h1>
<p>しばらく古典確率分布について考える。 パラメータに依存する確率分布 <span class="math inline">\(p_\theta(x)\)</span> のパラメータを最適化して、目標の確率分布 <span class="math inline">\(p(x)\)</span> の最も良い近似となるようにする問題を考える。</p>
<p>先程の議論でKL情報量が確率分布の距離のようなものを与えることを見たから、 KL情報量 <span class="math inline">\(\mathcal{D}\left(p||p_\theta\right)=\sum_i p(x)\ln{\frac{p(x)}{p_\theta(x)}}\)</span> を最小にする確率分布を求めれば問題が解けたことになる。</p>
<p>Natural Gradient Desentを用いて最小化を行うことを考えると計量の情報が必要となる。 十分近い2つの確率分布を用意し、KL情報量の計量を求めていく。</p>
<section id="重要な関係式" class="level2">
<h2 class="anchored" data-anchor-id="重要な関係式">重要な関係式</h2>
<p>KL情報量の計量を求めるのに便利な関係式を先に導いておこう。 まず、いかなる確率分布も総和は1である： <span class="math display">\[\sum_xp_\theta(x)=1\]</span> これを両辺パラメータ <span class="math inline">\(\theta\)</span> で微分して <span class="math display">\[\sum_x\partial_i p_\theta(x)=\sum_xp_\theta(x)\partial_i \ln{p}_\theta(x)\]</span></p>
<p><span class="math display">\[=\mathbb{E}_\theta \left[\partial_i \ln{p}_\theta(x)\right]=0\]</span></p>
<p>これは尤度の期待値が0であることを意味する。これをさらに微分して</p>
<p><span class="math display">\[\partial_j\sum_xp_\theta(x)\partial_i \ln{p}_\theta(x)=\sum_x\partial_j p_\theta(x)\partial_i \ln{p}_\theta(x)+\sum_xp_\theta(x)\partial_j\partial_i \ln{p}_\theta(x)\]</span></p>
<p><span class="math display">\[=\sum_xp_\theta(x)\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)+\sum_xp_\theta(x)\partial_j\partial_i \ln{p}_\theta(x)\]</span></p>
<p><span class="math display">\[=\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]+\mathbb{E}_\theta \left[\partial_j\partial_i \ln{p}_\theta(x)\right]=0\]</span></p>
<p>つまり、</p>
<p><span class="math display">\[\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]=-\mathbb{E}_\theta \left[\partial_j\partial_i \ln{p}_\theta(x)\right]\]</span> である。 次節の計算で以上の公式を用いる。</p>
</section>
<section id="kl情報量の計量" class="level2">
<h2 class="anchored" data-anchor-id="kl情報量の計量">KL情報量の計量</h2>
<p>計算の簡便のために、まずは十分異なる確率分布に対するKL情報量 <span class="math inline">\(\mathcal{D}\left(p||p_\theta\right)\)</span> から始めて、計算が終わった後で2つの確率分布を近づけることを考える。</p>
<p>まず、1階微分は <span class="math display">\[\partial_i \mathcal{D}\left(p||p_\theta\right)=\sum_i p(x)\partial_i \ln{\frac{p(x)}{p_\theta(x)}}=-\sum_i p(x) \frac{\partial_i p_\theta(x)}{p_\theta(x)}\]</span></p>
<p>続けて、2階微分は</p>
<p><span class="math display">\[\partial_j \partial_i \mathcal{D}\left(p||p_\theta\right)=-\sum_i p(x) \partial_j\frac{\partial_i p_\theta(x)}{p_\theta(x)}\]</span></p>
<p><span class="math display">\[=\sum_i p(x) \frac{\partial_i p_\theta(x)\partial_j p_\theta(x)}{p_\theta(x)^2}-\sum_i p(x) \frac{\partial_j\partial_i p_\theta(x)}{p_\theta(x)}\]</span> <span class="math display">\[=\sum_i p(x) \partial_i \ln{p}_\theta(x)\partial_j \ln{p}_\theta(x) -\sum_i p(x) \frac{\partial_j\partial_i p_\theta(x)}{p_\theta(x)}\]</span></p>
<p>ここで、</p>
<p><span class="math display">\[\partial_j\partial_i p_\theta(x)=\partial_j\left(p_\theta(x)\partial_i \ln{p}_\theta(x)\right)=\partial_j p_\theta(x)\partial_i \ln{p}_\theta(x) +p_\theta(x)\partial_j\partial_i \ln{p}_\theta(x)\]</span></p>
<p><span class="math display">\[=p_\theta(x)\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x) +p_\theta(x)\partial_j\partial_i \ln{p}_\theta(x)\]</span></p>
<p>であるから、</p>
<p><span class="math display">\[\partial_j \partial_i \mathcal{D}\left(p||p_\theta\right)=\sum_i p(x) \partial_i \ln{p}_\theta(x)\partial_j \ln{p}_\theta(x) -\sum_i p(x)\left( \partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x) +\partial_j\partial_i \ln{p}_\theta(x)\right)\]</span></p>
<p>となる。今、<span class="math inline">\(p\to p_\theta\)</span> に近づけていくと、前節に示した関係から1階微分は0となり、 二階微分は</p>
<p><span class="math display">\[\partial_j \partial_i \mathcal{D}\left(p||p_\theta\right)=-\sum_i p_\theta(x)\partial_j\partial_i \ln{p}_\theta(x)=-\mathbb{E}_\theta \left[\partial_j\partial_i \ln{p}_\theta(x)\right]=\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]\]</span></p>
<p>がわかる。結果的に、KL情報量は以下のように展開される：</p>
<p><span class="math display">\[\mathcal{D}\left(p_\theta||p_{\theta+d\theta}\right)=\frac{1}{2}\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]d\theta^id\theta^j\]</span></p>
<p>同じことだが、計量は</p>
<p><span class="math display">\[g_{ij}=\frac{1}{2}\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]\]</span></p>
<p>だとわかる。KL情報量の二階微分から出てきた寄与</p>
<p><span class="math display">\[\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]\]</span></p>
<p>は<strong>Fishcer情報行列</strong>と呼ばれる。 情報幾何学では、Fisher情報行列はパラメータ空間の曲がり具合を特徴づける重要な量として活躍する。</p>
<hr>
</section>
</section>
<section id="quantum-natural-gradient" class="level1">
<h1>Quantum Natural Gradient</h1>
<p>ここでは、<span class="citation" data-cites="Stokes2020quantumnatural">Stokes et al. (<a href="#ref-Stokes2020quantumnatural" role="doc-biblioref">2020</a>)</span> に準じてQuantum Natural Gradient (QNG)を導入する。</p>
<section id="量子状態間の距離の定義" class="level2">
<h2 class="anchored" data-anchor-id="量子状態間の距離の定義">量子状態間の距離の定義</h2>
<p>量子状態 <span class="math inline">\(\ket{\psi},\,\ket{\phi}\)</span> の距離を、コサイン類似度の角度で定義する：</p>
<p><span class="math display">\[
d\left(\ket{\psi},\ket{\phi}\right)=\arccos{\left|\Braket{\psi|\phi}\right|}
\]</span></p>
</section>
<section id="距離の公理" class="level2">
<h2 class="anchored" data-anchor-id="距離の公理">距離の公理</h2>
<p><span class="math inline">\(d\left(\ket{\psi},\ket{\phi}\right)=\arccos{\left|\Braket{\psi|\phi}\right|}\)</span> は本当に距離なのか確認したい。</p>
<ul>
<li><span class="math inline">\(d(a,a)=0\)</span>: 自明に成立する。</li>
<li><span class="math inline">\(d(a,b)=d(b,a)\)</span> : 自明に成立する。</li>
<li><span class="math inline">\(d(a,b)+d(b,c)\geq d(a,c)\)</span> : 3点が十分近ければ成立する<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>。以下を参照。</li>
</ul>
<p>三角不等式が成立することの略証を示す。 まず、全ての内積は適当なグローバル位相を各々のベクトルに掛けることで実になるようにとることができる。 このようにして得た3つのベクトルは単位超球面上の3点であり、不等式の各項は2点間の角度を表している。 角度は球面上の円弧の長さに対応するので、3辺の長さについて三角不等式が成り立つことから、問題の三角不等式も成り立つ。</p>
<p>以上からわかるように、三角不等式はふつう等式とならない。 <span class="math inline">\(a=\ket{0},b=\frac{1}{\sqrt{2}}\left(\ket{0}+\ket{1}\right),c=\frac{1}{\sqrt{2}}\left(\ket{0}+i\ket{1}\right)\)</span> とすると全ての元の間の距離が <span class="math inline">\(\arccos{\frac{1}{\sqrt{2}}}=\frac{\pi}{4}\)</span>となるので等号は成立しない。</p>
</section>
<section id="性質" class="level2">
<h2 class="anchored" data-anchor-id="性質">性質</h2>
<p>距離の非負性は距離の公理から導けるが、 <span class="math inline">\(\arccos{}\)</span> の値域を <span class="math inline">\([0,\pi]\)</span> にとれば値域が正となるようにできる。 また、引数に絶対値が乗っていることから結局値域は <span class="math inline">\([0,\pi/2]\)</span> まで制限される。</p>
<p>他にも、重要な性質を以下に記した：</p>
<ul>
<li><span class="math inline">\(d&gt;0\)</span></li>
<li><span class="math inline">\(d(\ket{0},\ket{1})=\frac{\pi}{2}\)</span></li>
<li><span class="math inline">\(\arccos^2{\sqrt{x}}\simeq -\left(x-1\right)+\mathcal{o}\left(\left(x-1\right)\right)\)</span></li>
</ul>
</section>
<section id="計量とquantum-natural-gradient" class="level2">
<h2 class="anchored" data-anchor-id="計量とquantum-natural-gradient">計量とQuantum Natural Gradient</h2>
<p><span class="math inline">\(\theta\)</span> でパラメータ付けした、微小な違いしか無い2ベクトル <span class="math inline">\(\ket{\psi_\theta},\ket{\psi_{\theta+d\theta}}\)</span> の距離を2次まで展開して計量を見てみる。計量 <span class="math inline">\(g_{ij}\)</span>の定義は</p>
<p><span class="math display">\[
d^2\left(\ket{\psi_\theta},\ket{\psi_{\theta+d\theta}}\right)
=\sum_{i,j}g_{ij}(\theta)d\theta^i d\theta^j
\]</span></p>
<p>とする。</p>
<p>まずは <span class="math inline">\(\Braket{\psi_\theta|\psi_{\theta+d\theta}}\)</span> を展開しておく。 <span class="math inline">\(\psi_{\theta+d\theta}= \psi_{\theta}+\partial_i\psi_{\theta}d\theta^i+\frac{1}{2}\partial_i\partial_j\psi_{\theta}d\theta^id\theta^j+\mathcal{O}(d\theta^3)\)</span> だから、 <span class="math display">\[\Braket{\psi_\theta|\psi_{\theta+d\theta}}\simeq \Braket{\psi_\theta|\psi_{\theta}}+\Braket{\psi_\theta|\partial_i\psi_{\theta}}d\theta^i+\frac{1}{2}\Braket{\psi_\theta|\partial_i\partial_j\psi_{\theta}}d\theta^id\theta^j\]</span></p>
<p><span class="math display">\[= 1+\Braket{\psi_\theta|\partial_i\psi_{\theta}}d\theta^i+\frac{1}{2}\Braket{\psi_\theta|\partial_i\partial_j\psi_{\theta}}d\theta^id\theta^j\]</span></p>
<p>すると、<span class="math inline">\(|\Braket{\psi_\theta|\psi_{\theta+d\theta}}|^2\)</span> を求めることができる：</p>
<p><span class="math display">\[|\Braket{\psi_\theta|\psi_{\theta+d\theta}}|^2\]</span> <span class="math display">\[
= 1+\left(\Braket{\psi_\theta|\partial_i\psi_{\theta}}+\Braket{\partial_i\psi_\theta|\psi_{\theta}}\right)d\theta^i+\left(\frac{1}{2}\Braket{\psi_\theta|\partial_i\partial_j\psi_{\theta}}+\frac{1}{2}\Braket{\partial_i\partial_j\psi_\theta|\psi_{\theta}}+\Braket{\partial_i\psi_\theta|\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}\right)d\theta^id\theta^j
\]</span></p>
<p><span class="math inline">\(\partial_i\braket{\psi_\theta|\psi_\theta}=\braket{\partial_i\psi_\theta|\psi_\theta}+\braket{\psi_\theta|\partial_i\psi_\theta}\)</span> である一方、<span class="math inline">\(\partial_i\braket{\psi_\theta|\psi_\theta}=\partial_i 1=0\)</span> であるから、 一次の項は0となる。</p>
<p>2次の項についても整理してみる。<span class="math inline">\(\partial_j\partial_i\braket{\psi_\theta|\psi_\theta}=\braket{\partial_j\partial_i\psi_\theta|\psi_\theta}+\braket{\psi_\theta|\partial_j\partial_i\psi_\theta}+\braket{\partial_i\psi_\theta|\partial_j\psi_\theta}+\braket{\partial_j\psi_\theta|\partial_i\psi_\theta}\)</span> である一方、<span class="math inline">\(\partial_j\partial_i\braket{\psi_\theta|\psi_\theta}=\partial_j\partial_i 1=0\)</span> であるから、</p>
<p><span class="math display">\[
|\Braket{\psi_\theta|\psi_{\theta+d\theta}}|^2
= 1+\left(\Braket{\partial_i\psi_\theta|\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}-\frac{1}{2}\Braket{\partial_i\psi_\theta|\partial_j\psi_{\theta}}-\frac{1}{2}\Braket{\partial_j\psi_\theta|\partial_i\psi_{\theta}}\right)d\theta^id\theta^j
\]</span></p>
<p>と書くことができる。<span class="math inline">\(x=1\)</span> 周りでの <span class="math inline">\(\arccos{}\)</span> のテイラー展開 <span class="math inline">\(\arccos^2{\sqrt{x}}\simeq 1-x^2\)</span> を使って</p>
<p><span class="math display">\[d^2\left(\ket{\psi_\theta},\ket{\psi_{\theta+d\theta}}\right)=\arccos^2{|\Braket{\psi_{\theta}|\psi_{\theta+d\theta}}|}\simeq 1-|\Braket{\psi_{\theta}|\psi_{\theta+d\theta}}|^2\]</span></p>
<p><span class="math display">\[=\left(\frac{1}{2}\Braket{\partial_i\psi_\theta|\partial_j\psi_{\theta}}+\frac{1}{2}\Braket{\partial_j\psi_\theta|\partial_i\psi_{\theta}}-\Braket{\partial_i\psi_\theta|\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}\right)d\theta^id\theta^j\]</span></p>
<p>を得る。結局、計量は</p>
<p><span class="math display">\[g_{ij}(\theta)=\frac{1}{2}\Braket{\partial_i\psi_\theta|\partial_j\psi_{\theta}}+\frac{1}{2}\Braket{\partial_j\psi_\theta|\partial_i\psi_{\theta}}-\Braket{\partial_i\psi_\theta|\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}\]</span> <span class="math display">\[={\rm Re}\left(\Braket{\partial_i\psi_\theta|\partial_j\psi_{\theta}}-\Braket{\partial_i\psi_\theta|\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}\right)\]</span></p>
<p>ということになる。文献ではこの形で止められていたが、1次の項を落としたときの議論によって</p>
<p><span class="math display">\[g_{ij}(\theta)={\rm Re}\left(\Braket{\partial_i\psi_\theta|\partial_j\psi_{\theta}}+\Braket{\psi_\theta|\partial_i\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}\right)\]</span></p>
<p>と書くこともできる。</p>
<p><span class="citation" data-cites="Stokes2020quantumnatural">Stokes et al. (<a href="#ref-Stokes2020quantumnatural" role="doc-biblioref">2020</a>)</span> によると、<span class="math inline">\(g_{ij}\)</span> は<strong>Fubini-Study計量テンソル</strong>、実部を取る前のテンソル <span class="math inline">\(\Braket{\partial_i\psi_\theta|\partial_j\psi_{\theta}}-\Braket{\partial_i\psi_\theta|\psi_{\theta}}\Braket{\psi_\theta|\partial_j\psi_{\theta}}\)</span> は<strong>Quantum Geometric Tensor</strong>と呼ばれる。</p>
<p><strong>Quantum Natural Gradient</strong>は、この計量を用いて更新式を作ったものである。</p>
<p><span class="math inline">\(\theta^i[n+1]=\theta^i[n]-\eta g^{ij}\partial_j \mathcal{L}|_{\theta^i=\theta^i[n]}\)</span></p>
</section>
<section id="古典情報量との対応" class="level2">
<h2 class="anchored" data-anchor-id="古典情報量との対応">古典情報量との対応</h2>
<p>Fubini-Study 計量テンソルの導出をFisher情報行列の導出と比較すると類似点が多いことに気づく。 ここでは、Fubini-Study 計量テンソルからFisher情報行列が導かれることについて論じる。</p>
<p>状態を <span class="math inline">\(\ket{\psi_\theta}=\sum_x c_\theta(x)\ket{x}\)</span> と展開する。 ここで <span class="math inline">\(p_\theta(x)=c_\theta(x)^2\)</span> と対応させる事にする。 両辺微分して</p>
<p><span class="math display">\[\ket{\partial_i\psi_\theta}=\sum_x \partial_i\sqrt{p_\theta(x)}\ket{x}=\frac{1}{2}\sum_x \frac{1}{\sqrt{p_\theta(x)}}\partial_ip_\theta(x)\ket{x}\]</span></p>
<p>すると <span class="math inline">\(\Braket{\psi_\theta|\partial_i\psi_\theta}\)</span> は以下のようになる： <span class="math display">\[\Braket{\psi_\theta|\partial_i\psi_\theta}=\frac{1}{2}\sum_{x,x'} \frac{\sqrt{p_\theta(x')}}{\sqrt{p_\theta(x)}}\partial_ip_\theta(x)\Braket{x'|x}=\frac{1}{2}\sum_{x} \partial_ip_\theta(x)=\frac{1}{2}\partial_i\sum_{x} p_\theta(x)=0\]</span></p>
<p>一方、<span class="math inline">\(\Braket{\partial_i\psi_\theta|\partial_j\psi_\theta}\)</span> は</p>
<p><span class="math display">\[\Braket{\partial_i\psi_\theta|\partial_j\psi_\theta}=\frac{1}{4}\sum_{x,x'} \frac{1}{\sqrt{p_\theta(x)p_\theta(x')}}\Braket{x'|x}\left(\partial_i p_\theta(x)\right)\left(\partial_j p_\theta(x')\right)\]</span></p>
<p><span class="math display">\[=\frac{1}{4}\sum_{x} \frac{1}{p_\theta(x)}\left(\partial_i p_\theta(x)\right)\left(\partial_j p_\theta(x)\right)\]</span></p>
<p><span class="math display">\[=\frac{1}{4}\sum_{x} p_\theta(x)\partial_i \ln{p}_\theta(x)\partial_j \ln{p}_\theta(x)=\frac{1}{4}\mathbb{E}_\theta \left[\partial_j \ln{p}_\theta(x)\partial_i \ln{p}_\theta(x)\right]\]</span></p>
<p>以上のように、Fubini-StudyはFisher情報行列には（古典確率分布と量子力学の波動関数の意味で）対応関係がある。</p>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-amari-naturalgradient" class="csl-entry" role="doc-biblioentry">
Amari, Shun-ichi. 1998. <span>“<span class="nocase">Natural Gradient Works Efficiently in Learning</span>.”</span> <em>Neural Computation</em> 10 (2): 251–76. <a href="https://doi.org/10.1162/089976698300017746">https://doi.org/10.1162/089976698300017746</a>.
</div>
<div id="ref-Josh2019" class="csl-entry" role="doc-biblioentry">
Izaac, Josh. 2019. <span>“Quantum Natural Gradient.”</span> <em>Pennylane Demos Optimization</em>. <a href="https://pennylane.ai/qml/demos/tutorial_quantum_natural_gradient.html">https://pennylane.ai/qml/demos/tutorial_quantum_natural_gradient.html</a>.
</div>
<div id="ref-Stokes2020quantumnatural" class="csl-entry" role="doc-biblioentry">
Stokes, James, Josh Izaac, Nathan Killoran, and Giuseppe Carleo. 2020. <span>“Quantum <span>N</span>atural <span>G</span>radient.”</span> <em><span>Quantum</span></em> 4 (May): 269. <a href="https://doi.org/10.22331/q-2020-05-25-269">https://doi.org/10.22331/q-2020-05-25-269</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>一般の場合どうなるのかまだ考えてない。<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>